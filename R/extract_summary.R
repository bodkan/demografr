#' Extract table of estimated model parameters
#'
#' @param abc ABC object generated by \code{perform_abc}
#' @param param Name of the model parameter
#' @param type Type of the model parameter ("Ne", "Tsplit", etc.)
#'
#' @export
extract_summary <- function(abc, param = NULL, type = NULL) {
  posterior_df <- as.data.frame.matrix(quiet(summary(abc)))

  params <- colnames(posterior_df)
  if (!is.null(param) && !is.null(type))
    stop("Provide either a parameter name or a type but not both", call. = FALSE)
  else if (!is.null(type)) {
    type <- match.arg(type, c("Ne", "Tgf", "Tsplit", "gf"))
    param <- grep(type, params, value = TRUE)
  } else if (is.null(param))
    param <- params

  posterior_df %>% dplyr::select(dplyr::starts_with(param))
}
